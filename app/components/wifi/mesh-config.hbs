<div class="card mb-3">
  <div class="card-header"><strong>Easy Mesh</strong></div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-2"><strong>Name</strong></div>
      <div class="col-md-7" style="margin-left: auto;">
        <Input class="form-control" type="text" @value={{@meshConfig.MultiAP.Name}} maxlength="50" style="width: 300px;" disabled/>
      </div>
    </div>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header"><strong>Nodes</strong></div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-12">
        <div class="mb-2">
          <strong>Name</strong>
          <span style="display: inline-block; width: 220px;"></span>
          <strong>Status</strong>
          <span style="display: inline-block; width: 145px;"></span>
          <strong>NextHop</strong>
          <span style="display: inline-block; width: 205px;"></span>
          <strong>Details</strong>
        </div>
        {{#each @meshConfig.MultiAP.Nodes as |node|}}
          <div class="row mb-2">
            <div class="col-md-3">
              <Input class="form-control" type="text" @value={{node.Name}} maxlength="50" style="width: 100%;" disabled/>
            </div>
            <div class="col-md-2">
              <span>{{node.Active}}</span>
            </div>
            <div class="col-md-3">
              {{#each @meshConfig.DataElements.Network.Device as |device|}}
                      {{did-insert (fn this.storeBackhaulid device.MultiAPDevice.Backhaul.BackhaulDeviceID)}}
              {{/each}}
              <span>{{this.backhaul}}</span>
              {{did-insert (fn this.resetNode)}}
            </div>
            <div class="col-md-2">
              {{#each @meshConfig.DataElements.Network.Device as |device|}}
                {{#each device.Radio as |radio|}}
                {{#each radio.BSS as |bss|}}
                  {{#each bss.STA as |sta|}}
                      {{did-insert (fn this.storeSignalStrength sta)}}
                      {{did-insert (fn this.storeMAC sta)}}
                      {{did-insert (fn this.storeMACAddress device.MultiAPDevice.Backhaul.MACAddress)}}
                      {{did-insert (fn this.storeBackhaulid device.MultiAPDevice.Backhaul.BackhaulDeviceID)}}
              {{/each}}
                    {{/each}}
              {{/each}}
              {{/each}}
              {{#each @meshConfig.DataElements.Network.Device as |device|}}
                {{did-insert (fn this.storeBackhaul device.MultiAPDevice.Backhaul.LinkType)}}
                {{log device.MultiAPDevice.Backhaul.LinkType}}
                {{did-insert (fn this.storeMACAddress device.MultiAPDevice.Backhaul.MACAddress)}}
                {{did-insert (fn this.resetNode)}}
              {{/each}}
              
              <button class="btn btn-primary" {{on "click" (fn this.showModal node)}}>Show</button>
            </div>
          </div>
        {{/each}}
      </div>
    </div>
  </div>
</div>

<div class="card mb-3">
  <div class="card-header"><strong>Nodes</strong></div>
  <div class="card-body">
    <div class="row">
      <div class="col-md-12">
        <div class="mb-2">
          <strong>Name</strong>
          <span style="display: inline-block; width: 205px;"></span>
          <strong>Status</strong>
          <span style="display: inline-block; width: 120px;"></span>
          <strong>Nodes</strong>
          <span style="display: inline-block; width: 220px;"></span>
          <strong>Policy</strong>
          <span style="display: inline-block; width: 215px;"></span>
          <strong>Details</strong>
        </div>
{{#each @meshConfig.MultiAP.Devices as |devices|}}
  <div class="row mb-2">
    <div class="col-md-2">
      {{devices.Name}}
    </div>
    <div class="col-md-2">
      <span style="margin-left: 77px;">{{devices.Active}}</span>
    </div>
    <div class="col-md-2">
      <span style="margin-left: 55px;">{{devices.Name}}</span>
    </div>

    <div class="col-md-2" >
      <select class="form-control" style="margin-left: 110px;" value={{this.selectedPolicy}} {{on "change" this.updatePolicy}}>
        <option value="Normal">Normal</option>
        <option value="No Steer">No Steer</option>
      </select>
    </div>

      {{#each @meshConfig.DataElements.Network.Device as |device|}}
        {{#each device.Radio as |radio|}}
          {{#each radio.BSS as |bss|}}
            {{#each bss.STA as |sta|}}
              {{did-insert (fn this.storeSignalStrength sta)}}
              {{did-insert (fn this.storeLinkRate sta.LastDataUplinkRate)}}
              {{did-insert (fn this.storeMAC sta)}}
                {{#each radio.CurrentOperatingClasses as |curr|}}
                  {{did-insert (fn this.storeChannel curr.Channel)}}
                {{/each}}
            {{/each}}
          {{/each}}
        {{/each}}
      {{/each}}


      {{#each @meshConfig.DataElements.Network.Device as |device|}}
        {{did-insert (fn this.storeBackhaul device.MultiAPDevice.Backhaul.LinkType)}}
        {{did-insert (fn this.storeMACAddress device.MultiAPDevice.Backhaul.MACAddress)}}
      {{/each}}
    <div class="col-md-2">
      <button class="btn btn-primary" style="margin-left: 200px;" {{on "click" (fn this.showDeviceModal devices)}}>Show</button>
    </div>
  </div>
{{/each}}
</div>
</div>
</div>
</div>
<div id="nodeModal" class="modal" {{did-insert this.setupModal}}>
  <div class="modal-content">
    <button class="close" {{on "click" this.closeModal}}>&times;</button>
    <h5>Node Details</h5>
    <p><strong>Name:</strong> <span id="modalNodeName"></span></p>
    <p><strong>Status:</strong> <span id="modalNodeStatus"></span></p>
    <p><strong>NextHop:</strong> <span id="modalNodeNextHop"></span></p>
    <p><strong>FirmwareVersion:</strong> <span id="modalNodeSoftwareVersion"></span></p>
    <p><strong>MAC Address:</strong> <span id="modalNodeMACAddress"></span></p>
    <p><strong>IP Address:</strong> <span id="modalNodeIPAddress"></span></p>
    <p><strong>Signal Strength:</strong><span id="modalStaSignalStrength"></span></p>
    <p><strong>LinkType:</strong><span id="modalLinktype"></span></p>
  </div>
</div>
<div id="deviceModal" class="modal" {{did-insert this.setupModal}}>
  <div class="modal-content">
    <button class="close" {{on "click" this.closeDeviceModal}}>&times;</button>
    <h5>Device Details</h5>
    <p><strong>Name:</strong> <span id="modalDeviceName"></span></p>
    <p><strong>MAC Address:</strong> <span id="modalDeviceMACAddress"></span></p>
     <p><strong>Node:</strong> <span id="modalDeviceNextHop"></span></p>
    <p><strong>IP Address:</strong> <span id="modalDeviceIPAddress"></span></p>
    <p><strong>Signal Strength:</strong><span id="modalDeviceSignalStrength"></span></p>
    <p><strong>Link Rate:</strong><span id="modalDeviceLinkRate"></span></p>
    <p><strong>Frequency:</strong><span id="modalDeviceFrequency"></span></p>
    <p><strong>Status:</strong> <span id="modalDeviceStatus"></span></p>
  </div>
</div>
<style>
  .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgb(0,0,0);
    background-color: rgba(0,0,0,0.4);
  }

  .modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border: 1px solid #888;
    width: 80%;
    padding-left: 100px; 
  }

.close {
  color: #aaa;
  float: right;
  font-size: 20px;
  font-weight: bold;
  background: none;
  border: none;
  cursor: pointer;
  padding: 0;
}

.close:hover,
.close:focus {
  color: black;
  text-decoration: none;
}
</style>